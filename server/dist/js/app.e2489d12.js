(function(e){function t(t){for(var n,s,o=t[0],l=t[1],c=t[2],u=0,d=[];u<o.length;u++)s=o[u],r[s]&&d.push(r[s][0]),r[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);p&&p(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,o=1;o<a.length;o++){var l=a[o];0!==r[l]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},r={app:0},i=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var p=l;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("c21b"),r=a.n(n);r.a},"192d":function(e,t,a){},"1b1d":function(e,t,a){"use strict";var n=a("3d0b"),r=a.n(n);r.a},"3d0b":function(e,t,a){},5535:function(e,t,a){"use strict";var n=a("192d"),r=a.n(n);r.a},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("097d");var n=a("2b0e"),r=a("8c4f"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("Content",{staticClass:"main"},[a("router-view")],1),e._m(0),a("BackTop")],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-footer"},[e._v("@author MaChao   TEL:3715   PHONE:61907 "),a("br"),e._v(" Build with Node.js,Express,MongoDB,Vue,Vue-Router and iView "),a("br"),e._v(" All source code shared")])}],o={},l=o,c=(a("034f"),a("2877")),p=Object(c["a"])(l,i,s,!1,null,null,null);p.options.__file="App.vue";var u=p.exports,d=a("e069"),f=a.n(d),m=(a("dcad"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-wrap"},[a("Card",{staticClass:"card-login",attrs:{bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("span",[e._v("iPaper问卷系统")])]),e.isLoginForm?e._e():a("Form",{key:"codeForm",ref:"codeForm",staticClass:"login-form",attrs:{model:e.codeData,rules:e.ruleCodeForm}},[a("FormItem",{attrs:{prop:"code"}},[a("Input",{staticClass:"input-code login-input",attrs:{type:"text",placeholder:"请输入问卷码",clearable:"",autofocus:""},model:{value:e.codeData.code,callback:function(t){e.$set(e.codeData,"code",t)},expression:"codeData.code"}},[a("Icon",{attrs:{slot:"prepend",type:"md-barcode"},slot:"prepend"})],1)],1),a("FormItem",[a("Button",{staticClass:"button-enter button-left",attrs:{type:"success",size:"large",ghost:""},on:{click:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.onEnter("codeForm")}}},[e._v("Enter\n                ")]),a("Button",{staticClass:"button-login",attrs:{type:"text"},on:{click:function(t){e.toggleFormType("codeForm")}}},[e._v("我是出卷人\n                ")])],1)],1),e.isLoginForm?a("Form",{key:"loginForm",ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginData,rules:e.ruleLoginForm}},[a("FormItem",{attrs:{prop:"account"}},[a("Input",{staticClass:"input-account login-input",attrs:{type:"text",placeholder:"请输入账号",clearable:""},model:{value:e.loginData.account,callback:function(t){e.$set(e.loginData,"account",t)},expression:"loginData.account"}},[a("Icon",{attrs:{slot:"prepend",type:"ios-person-outline"},slot:"prepend"})],1)],1),a("FormItem",{attrs:{prop:"password"}},[a("Input",{staticClass:"input-password login-input",attrs:{type:"password",placeholder:"请输入密码",clearable:""},model:{value:e.loginData.password,callback:function(t){e.$set(e.loginData,"password",t)},expression:"loginData.password"}},[a("Icon",{attrs:{slot:"prepend",type:"ios-lock-outline"},slot:"prepend"})],1)],1),a("FormItem",[a("Button",{staticClass:"button-login button-left",attrs:{type:"success",size:"large",ghost:""},on:{click:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.onEnter("loginForm")}}},[e._v("Login\n                ")]),a("Button",{staticClass:"button-back",attrs:{type:"warning",size:"large",ghost:""},on:{click:function(t){e.toggleFormType("loginForm")}}},[e._v("\n                    Back\n                ")])],1)],1):e._e()],1)],1)}),h=[],v={data:function(){return{isLoginForm:!1,codeData:{code:""},ruleCodeForm:{code:[{required:!0,message:"Please fill in code.",trigger:"blur"}]},loginData:{account:"",password:""},ruleLoginForm:{account:[{required:!0,message:"Please fill in account.",trigger:"blur"}],password:[{required:!0,message:"Please fill in password.",trigger:"blur"}]}}},created:function(){},methods:{onEnter:function(e){var t=this;if("codeForm"===e)this.$refs[e].validate(function(e){e?t.$fetch.get("/enter",{paperCode:t.codeData.code},function(e){e&&t.$router.push({name:"blank",params:{paperCode:t.codeData.code}})}):t.$Message.error("Fail!")});else{if("loginForm"!==e)return null;this.$refs[e].validate(function(e){e?t.$fetch.post("/login",{name:t.loginData.account,password:t.loginData.password},function(e){e&&e.token&&(window.localStorage.setItem("token",e.token),window.localStorage.setItem("userName",t.loginData.account),t.$router.push({name:"list"}))}):t.$Message.error("Fail!")})}},toggleFormType:function(e){this.$refs[e].resetFields(),this.isLoginForm=!this.isLoginForm}}},b=v,g=(a("59bc"),Object(c["a"])(b,m,h,!1,null,"7ca431d4",null));g.options.__file="Login.vue";var x=g.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"blank-wrap"},[a("Card",{staticClass:"title-card"},[a("div",{staticStyle:{"text-align":"center"}},[a("Tooltip",{attrs:{content:"点击查看详情",placement:"right"}},[a("h2",{staticClass:"item-title",on:{click:function(t){e.getDetail("P",e.paper.code)}}},[e._v(e._s(this.paper.title))])]),a("h4",[e._v(e._s("问卷码: "+this.paper.code+" 截至:"+e.paper.dateLine))]),a("h4",[e._v(e._s("创建人:"+e.paper.creator+" 创建日期:"+e.paper.createDate+" 联系方式:"+e.paper.contact))])],1)]),a("Card",{staticClass:"profile-card card-item"},[a("Form",{ref:"profileForm",attrs:{model:e.profile,rules:e.ruleProfile,"label-width":100,inline:""}},[a("FormItem",{attrs:{label:"工号",prop:"number"}},[a("Input",{attrs:{placeholder:"Enter your number",clearable:""},model:{value:e.profile.number,callback:function(t){e.$set(e.profile,"number",t)},expression:"profile.number"}})],1),a("FormItem",{attrs:{label:"姓名",prop:"name"}},[a("Input",{attrs:{placeholder:"Enter your name",clearable:""},model:{value:e.profile.name,callback:function(t){e.$set(e.profile,"name",t)},expression:"profile.name"}})],1),a("FormItem",{attrs:{label:"部门",prop:"department"}},[a("Input",{attrs:{placeholder:"Enter your department",clearable:""},model:{value:e.profile.department,callback:function(t){e.$set(e.profile,"department",t)},expression:"profile.department"}})],1),a("FormItem",{attrs:{label:"联系方式",prop:"contact"}},[a("Input",{attrs:{placeholder:"Enter your contact",clearable:""},model:{value:e.profile.contact,callback:function(t){e.$set(e.profile,"contact",t)},expression:"profile.contact"}})],1),a("FormItem",{staticClass:"remark-input",attrs:{label:"备注",prop:"remark"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"Enter the remark...",clearable:""},model:{value:e.profile.remark,callback:function(t){e.$set(e.profile,"remark",t)},expression:"profile.remark"}})],1)],1)],1),e._l(e.paper.questions,function(t){return a("div",{key:t.index,staticClass:"question-card"},[a("Card",{attrs:{bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("Tooltip",{attrs:{content:"点击查看详情",placement:"right"}},[a("span",{staticClass:"item-title",on:{click:function(a){e.getDetail("Q",t.index)}}},[e._v(e._s(Number(t.index)+1+" . "+t.title)+e._s(t.required?"【必答项】":""))])])],1),"SINGLE"===t.type?a("div",[a("RadioGroup",{attrs:{vertical:""},model:{value:e.answers[t.index].answer[0],callback:function(a){e.$set(e.answers[t.index].answer,0,a)},expression:"answers[question.index].answer[0]"}},e._l(t.items,function(t){return a("Radio",{key:t.index,attrs:{label:t.index}},[a("span",{staticClass:"item-index"},[e._v(e._s(t.index))]),a("span",{staticClass:"item-content"},[e._v(e._s(t.content))])])}))],1):"MULTIPLE"===t.type?a("div",[a("CheckboxGroup",{model:{value:e.answers[t.index].answer,callback:function(a){e.$set(e.answers[t.index],"answer",a)},expression:"answers[question.index].answer"}},e._l(t.items,function(t){return a("p",{key:t.index},[a("Checkbox",{attrs:{label:t.index}},[a("span",{staticClass:"item-index"},[e._v(e._s(t.index))]),a("span",{staticClass:"item-content"},[e._v(e._s(t.content))])])],1)}))],1):"INPUT"===t.type?a("div",[a("Input",{attrs:{type:"textarea",autosize:!0,placeholder:"请输入..."},model:{value:e.answers[t.index].answer[0],callback:function(a){e.$set(e.answers[t.index].answer,0,a)},expression:"answers[question.index].answer[0]"}})],1):a("div",[a("P",[e._v("错误")])],1)])],1)}),a("Card",{staticClass:"action-card"},[a("div",{staticStyle:{"text-align":"center"}},[a("Button",{staticClass:"action-button",attrs:{type:"success",ghost:""},on:{click:e.submit}},[e._v("提交")]),a("Button",{staticClass:"action-button",attrs:{type:"warning",ghost:""},on:{click:e.back}},[e._v("返回")])],1)])],2)},_=[],C=(a("f751"),a("c5f6"),{data:function(){return{paperCode:this.$route.params.paperCode,paper:{},profile:{number:"",name:"",department:"",remark:""},answers:[],ruleProfile:{number:[{required:!0,message:"Please input your number",trigger:"blur"}],name:[{required:!0,message:"Please input your name",trigger:"blur"}],contact:[{required:!0,message:"Please input your contact",trigger:"blur"}],department:[{required:!0,message:"Please input your department",trigger:"blur"}],remark:[{required:!1}]}}},created:function(){var e=this;this.fetchData(function(){e.paper&&e.paper.questions&&(e.answers=e.paper.questions.map(function(e){return{index:e.index,required:e.required,type:e.type,answer:[]}}))})},methods:{fetchData:function(e){var t=this;this.$fetch.get("/getPaperByCode",{paperCode:this.paperCode},function(a){a&&(t.paper=a),e()})},getDetail:function(e,t){var a="",n="";if("P"===e)a=t+"  "+this.paper.title,n=this.paper.description;else if("Q"===e){var r=this.paper.questions.filter(function(e){return e.index===t})[0];a=Number(t)+1+" . "+r.title,n=r.description}this.$Modal.confirm({title:a,content:"<p>"+n+"</p>",okText:"确定",cancelText:" "})},submit:function(){var e=this,t=Object.assign({paperCode:this.paperCode},this.profile);t.answers=this.answers,console.log(t),this.$Modal.confirm({title:"确认",content:"<p>确定提交此答卷?</p>",onOk:function(){e.$refs["profileForm"].validate(function(a){a&&!e.answers.some(function(e){return alert(e.answer.length),e.required&&0===e.answer.length})?e.$fetch.post("/submitAnswer",{answer:t},function(t){200===t&&e.$router.push({name:"login"})}):e.$Message.error("尚有未选择的项,请检查!")})},onCancel:function(){}})},back:function(){this.$router.push("/login")}}}),k=C,y=(a("1b1d"),Object(c["a"])(k,w,_,!1,null,"53c81898",null));y.options.__file="BlankEdit.vue";var I=y.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-wrap"},[a("div",{staticClass:"user-name"},[a("span",{staticClass:"user-name-text"},[e._v(e._s(e.userName))])]),a("div",{staticClass:"menu-actions"},[a("a",{staticClass:"action-button",attrs:{href:"javascript:void (0);",title:"新建问卷"},on:{click:e.addPaper}},[a("Icon",{attrs:{type:"md-add-circle"}})],1),a("br"),a("a",{staticClass:"action-button",attrs:{href:"javascript:void (0);",title:"后退"},on:{click:e.backPage}},[a("Icon",{attrs:{type:"ios-arrow-dropleft-circle"}})],1),a("br"),a("a",{staticClass:"action-button",attrs:{href:"javascript:void (0);",title:"前进"},on:{click:e.forwardPage}},[a("Icon",{attrs:{type:"ios-arrow-dropright-circle"}})],1),"list"!==e.$route.name?a("br"):e._e(),"list"!==e.$route.name?a("a",{staticClass:"action-button",attrs:{href:"javascript:void (0);",title:"主页"},on:{click:e.goHome}},[a("Icon",{attrs:{type:"md-home"}})],1):e._e(),a("br"),a("a",{staticClass:"action-button",attrs:{href:"javascript:void (0);",title:"退出登陆"},on:{click:e.logout}},[a("Icon",{attrs:{type:"md-log-out"}})],1)]),a("router-view")],1)},E=[],q={data:function(){return{userName:""}},created:function(){this.userName=window.localStorage.getItem("userName")},methods:{addPaper:function(){this.$router.push("/paper/create")},goHome:function(){this.$router.push("/paper")},backPage:function(){this.$router.go(-1)},forwardPage:function(){this.$router.go(1)},logout:function(){var e=this;this.$Modal.confirm({title:"确认",content:"<p>确定退出登陆？</p>",onOk:function(){window.localStorage.setItem("token",null),window.localStorage.setItem("userName",null),e.$router.push("/login")},onCancel:function(){}})}}},P=q,F=(a("5535"),Object(c["a"])(P,$,E,!1,null,"265c9b36",null));F.options.__file="Papers.vue";var S=F.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrap-create"},[a("Card",{staticClass:"title-card"},[a("p",{staticClass:"title-text",attrs:{slot:"title"},slot:"title"},[a("span",[e._v("新建问卷")])])]),a("Card",{staticClass:"paper-card card-item"},[a("Form",{ref:"paperForm",attrs:{model:e.paper,rules:e.rulePaper,"label-width":100}},[a("FormItem",{attrs:{label:"问卷标题",prop:"title"}},[a("Input",{attrs:{placeholder:"Enter the title",clearable:""},model:{value:e.paper.title,callback:function(t){e.$set(e.paper,"title",t)},expression:"paper.title"}})],1),a("FormItem",{attrs:{label:"截至",prop:"dateLine"}},[a("DatePicker",{attrs:{type:"date",format:"yyyy-MM-dd",placeholder:"Select date"},model:{value:e.paper.dateLine,callback:function(t){e.$set(e.paper,"dateLine",t)},expression:"paper.dateLine"}})],1),a("FormItem",{attrs:{label:"创建者",prop:"creator"}},[a("Input",{attrs:{placeholder:"Enter the creator",clearable:""},model:{value:e.paper.creator,callback:function(t){e.$set(e.paper,"creator",t)},expression:"paper.creator"}})],1),a("FormItem",{attrs:{label:"联络方式",prop:"contact"}},[a("Input",{attrs:{placeholder:"Enter your cellphone number or email",clearable:""},model:{value:e.paper.contact,callback:function(t){e.$set(e.paper,"contact",t)},expression:"paper.contact"}})],1),a("FormItem",{attrs:{label:"问卷描述",prop:"description"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"Enter the description...",clearable:""},model:{value:e.paper.description,callback:function(t){e.$set(e.paper,"description",t)},expression:"paper.description"}})],1),a("FormItem",{attrs:{label:"期望参与数",prop:"expect"}},[a("Input",{attrs:{placeholder:"Enter a number",clearable:""},model:{value:e.paper.expect,callback:function(t){e.$set(e.paper,"expect",t)},expression:"paper.expect"}})],1)],1)],1),a("Card",{staticClass:"card-item"},[a("p",{staticClass:"question-card-title",attrs:{slot:"title"},slot:"title"},[a("span",[e._v("题目列表")])]),e._l(e.paper.questions,function(t,n){return a("Card",{key:n,staticClass:"question-card card-item  question-list",attrs:{bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("span",[e._v(e._s(n+1+" . "+t.title))])]),a("p",[e._v("题目类型:"+e._s(t.type)+" 必填"+e._s(t.required))]),"INPUT"!==t.type?a("div",e._l(t.items,function(t){return a("p",{key:t.index},[a("span",{staticClass:"item-index"},[e._v(e._s(t.index))]),a("span",{staticClass:"item-content"},[e._v(e._s(t.content))])])})):a("div",[a("P")],1)])})],2),a("Card",{staticClass:"add-card card-item"},[a("Form",{ref:"questionForm",attrs:{model:e.newQuestion,rules:e.ruleQuestion,"label-width":80}},[a("FormItem",{attrs:{label:"题目",prop:"title"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"Enter the question...",clearable:""},model:{value:e.newQuestion.title,callback:function(t){e.$set(e.newQuestion,"title",t)},expression:"newQuestion.title"}})],1),a("FormItem",{attrs:{label:"",prop:"required"}},[a("Checkbox",{staticClass:"required-checkbox",model:{value:e.newQuestion.required,callback:function(t){e.$set(e.newQuestion,"required",t)},expression:"newQuestion.required"}},[e._v("必填")])],1),a("FormItem",{attrs:{label:"",prop:"type"}},[a("RadioGroup",{model:{value:e.newQuestion.type,callback:function(t){e.$set(e.newQuestion,"type",t)},expression:"newQuestion.type"}},[a("Radio",{attrs:{label:"SINGLE"}},[e._v("单选题")]),a("Radio",{attrs:{label:"MULTIPLE"}},[e._v("多选题")]),a("Radio",{attrs:{label:"INPUT"}},[e._v("填写题")])],1)],1),"INPUT"!==e.newQuestion.type?a("div",{staticStyle:{"text-align":"left"}},[a("FormItem",{attrs:{label:"选项数目",prop:"itemsSize"}},[a("InputNumber",{attrs:{max:12,min:1},model:{value:e.itemsSize,callback:function(t){e.itemsSize=t},expression:"itemsSize"}})],1),e._l(e.newQuestion.items,function(t,n){return a("P",{key:n,staticClass:"question-item-group"},[a("label",{staticClass:"question-item-index"},[e._v(e._s(e.questionItemList[n]+" :"))]),a("Input",{staticClass:"question-item-input",attrs:{type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"Enter the content",clearable:""},model:{value:t.content,callback:function(a){e.$set(t,"content",a)},expression:"item.content"}})],1)})],2):e._e()],1),a("div",{staticStyle:{"text-align":"center"}},[a("Button",{on:{click:e.addQuestion}},[e._v("添加")])],1)],1),a("Card",{staticClass:"action-card card-item"},[a("div",{staticStyle:{"text-align":"center"}},[a("Button",{attrs:{type:"success"},on:{click:e.handleSubmit}},[e._v("提交问卷表")])],1)])],1)},D=[],O={data:function(){return{paper:{title:"",dateLine:"",creator:"",contact:"",description:"",expect:"",questions:[]},rulePaper:{title:[{required:!0,message:"The title cannot be empty",trigger:"blur"}],dateLine:[{required:!1}],contact:[{required:!0,message:"Please input your contact",trigger:"blur"}],creator:[{required:!0,message:"Please input the creator",trigger:"blur"}],description:[{required:!1}],expect:[{required:!0,message:"Please input the creator",trigger:"blur"}]},questionItemList:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T"],itemsSize:1,newQuestion:{title:"",type:"SINGLE",required:!0,items:[{index:"A",content:""}]},ruleQuestion:{title:[{required:!0,message:"The title cannot be empty",trigger:"blur"}]}}},watch:{itemsSize:function(e,t){var a=0;if(e>t){a=e-t;for(var n=0;n<a;n++)this.newQuestion.items.push({index:this.questionItemList[t+n],content:""})}else if(e<t){a=t-e;for(var r=0;r<a;r++)this.newQuestion.items.pop()}}},methods:{addQuestion:function(){var e=this;this.$refs["questionForm"].validate(function(t){t?(e.$Message.success("验证通过!"),e.paper.questions.push(JSON.parse(JSON.stringify(e.newQuestion))),e.itemsSize=1,e.newQuestion.title="",e.newQuestion.required=!0,e.newQuestion.items[0].content=""):e.$Message.error("验证失败!")})},handleSubmit:function(){var e=this;this.$Modal.confirm({title:"确认",content:"<p>确定新建此问卷?</p>",onOk:function(){e.$refs["paperForm"].validate(function(t){if(t){for(var a=0;a<e.paper.questions.length;a++)e.paper.questions[a]["index"]=a;var n=e.paper.dateLine;e.paper.dateLine=n.getFullYear()+"-"+n.getMonth()+"-"+n.getDate(),e.$fetch.post("/api/submitPaper",{paperData:e.paper},function(t){200===t&&(e.$Notice.open({title:"这里是您创建的问卷码"+t.paperCode,desc:t.paperCode,duration:0}),e.$router.push({name:"list"}))})}else e.$Message.error("数据验证失败,请检查!")})},onCancel:function(){}})}}},T=O,j=(a("cf0d"),Object(c["a"])(T,L,D,!1,null,"5b9f626b",null));j.options.__file="PaperCreate.vue";var N=j.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail-wrap"},[a("Card",{staticClass:"title-card"},[a("p",{staticClass:"title-text",attrs:{slot:"title"},slot:"title"},[a("span",[e._v("问卷详情")])])]),a("Card",{staticClass:"title-card"},[a("div",{staticStyle:{"text-align":"center"}},[a("Tooltip",{attrs:{content:"点击查看详情",placement:"right"}},[a("h2",{staticClass:"item-title",on:{click:function(t){e.getDetail("P",e.paper.code)}}},[e._v(e._s(this.paper.title))])]),a("h4",[e._v(e._s("问卷码: "+this.paper.code+"截至:"+e.paper.dateLine))]),a("h4",[e._v(e._s("创建人:"+e.paper.creator+" 创建日期:"+e.paper.createDate+"   联系方式:"+e.paper.contact))])],1)]),a("Card",{staticClass:"card-item"},e._l(e.paper.questions,function(t,n){return a("Card",{key:n,staticClass:"question-card card-item  question-list",attrs:{bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("span",[e._v(e._s(t.title))])]),a("p",[e._v("题目类型:"+e._s(t.type)+" 必填"+e._s(t.required))]),"INPUT"!==t.type?a("div",e._l(t.items,function(t){return a("p",{key:t.index},[a("span",{staticClass:"item-index"},[e._v(e._s(t.index))]),a("span",{staticClass:"item-content"},[e._v(e._s(t.content))])])})):a("div",[a("P")],1)])}))],1)},Q=[],B={data:function(){return{paperId:this.$route.params.paperId,paper:{},answers:[]}},created:function(){var e=this;this.fetchData(function(){e.paper.questions&&(e.answers=e.paper.questions.map(function(e){var t;switch(e.item){case"SINGLE":t="";break;case"MULTIPLE":t=[];break;case"INPUT":t="";break}return{code:e.code,required:e.required,answer:t}}))})},methods:{fetchData:function(e){var t=this;this.$fetch.get("/api/paperDetail",{paperId:this.paperId},function(a){t.paper=a,e()})},getDetail:function(e,t){var a="",n="";if("P"===e)a=t+"  "+this.paper.title,n=this.paper.description;else if("Q"===e){var r=this.paper.questions.filter(function(e){return e.code===t})[0];a=Number(t)+1+" . "+r.title,n=r.description}this.$Modal.confirm({title:a,content:"<p>"+n+"</p>",okText:"确定",cancelText:" "})}}},A=B,R=(a("d1f8"),Object(c["a"])(A,M,Q,!1,null,"1a94dc5c",null));R.options.__file="PaperDetail.vue";var z=R.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"analysis-wrap"},[a("Card",{staticClass:"title-card"},[a("p",{staticClass:"title-text",attrs:{slot:"title"},slot:"title"},[a("span",[e._v("答卷分析")])])]),a("Card",{staticClass:"title-card card-item"},[a("div",{staticStyle:{"text-align":"center"}},[a("h2",{staticClass:"item-title",on:{click:function(t){e.getDetail("P",e.paper.code)}}},[e._v(e._s(this.paper.title))]),a("h4",[e._v(e._s("问卷码: "+this.paper.code+"截至:"+e.paper.dateLine))]),a("h4",[e._v(e._s("创建人:"+e.paper.creator+" 创建日期:"+e.paper.createDate+" 联系方式:"+e.paper.contact))])])]),a("Card",{staticClass:"content-card card-item"},[a("p",{attrs:{slot:"title",href:"javascript:void(0);"},slot:"title"},[e._v("\n            答题情况表\n        ")]),a("a",{attrs:{slot:"extra",href:"javascript:void(0);"},on:{click:e.exportExcel},slot:"extra"},[a("span",{attrs:{title:"导出EXCEL文件"}},[e._v("导出")])]),e.tableColumns?a("Table",{ref:"answertable",attrs:{width:"auto",height:"auto",border:"",columns:e.tableColumns,data:e.tableData}}):e._e()],1)],1)},G=[],W=(a("20d6"),a("7f7f"),a("6b54"),a("ac6a"),a("ac4d"),a("8a81"),a("a481"),function(){var e=window.navigator.userAgent;return e.indexOf("MSIE")>=0?"ie":e.indexOf("Firefox")>=0?"Firefox":e.indexOf("Chrome")>=0?"Chrome":e.indexOf("Opera")>=0?"Opera":e.indexOf("Safari")>=0?"Safari":void 0}),H=function(e,t){if("ie"==W()){var a=e,n=new ActiveXObject("Excel.Application"),r=n.Workbooks.Add(),i=r.Worksheets(1),s=document.body.createTextRange();s.moveToElementText(a),s.select,s.execCommand("Copy"),i.Paste(),n.Visible=!0;try{n.Application.GetSaveAsFilename("Excel.xls","Excel Spreadsheets (*.xls), *.xls")}catch(e){print("Nested catch caught "+e)}finally{r.SaveAs(fname),r.Close(savechanges=!1),n.Quit(),n=null,window.setInterval("Cleanup();",1),window.setInterval("Cleanup();",1)}}else J(e,t)},J=function(){var e="data:application/vnd.ms-excel;base64,",t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',a=function(e){return window.btoa(unescape(encodeURIComponent(e)))},n=function(e,t){return e.replace(/{(\w+)}/g,function(e,a){return t[a]})};return function(r,i){var s={worksheet:i,table:r},o=document.createElement("a");o.setAttribute("href",e+a(n(t,s))),o.setAttribute("download",i),o.click()}}(),V=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Worksheet",n=[],r=document.createElement("table"),i=document.createElement("thead"),s=t.$el.getElementsByClassName("ivu-table-tbody")[0].cloneNode(!0),o=document.createElement("tr"),l=!0,c=!1,p=void 0;try{for(var u,d=e[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;n.push(f.key);var m=document.createElement("th"),h=document.createTextNode(f.title);m.appendChild(h),o.appendChild(m)}}catch(e){c=!0,p=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw p}}i.appendChild(o),r.appendChild(i),r.appendChild(s),console.log(r),H(r.innerHTML,a)},X={data:function(){var e=this;return{paperId:this.$route.params.paperId,paper:{},tableColumns:[{title:"操作",key:"action",fixed:"left",width:70,align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"warning",ghost:!0,size:"small"},on:{click:function(){e.deleteItem(a.index)}}},"删除")])}},{title:"序号",key:"_index",fixed:"left",width:90,align:"center",sortable:!0},{title:"姓名",key:"name",width:100,fixed:"left",align:"center",sortable:!0},{title:"工号",key:"number",width:100,align:"center",sortable:!0},{title:"部门",key:"department",width:100,align:"center",sortable:!0},{title:"备注",key:"remark",width:170,align:"center"}],tableData:[]}},created:function(){var e=this;this.fetchData(function(){e.paper.questions&&e.paper.questions.forEach(function(t){e.tableColumns.push({title:t.title,key:t.index,width:t.title.length>16?200:100,align:"center"})});var t=e.paper.answerList;t&&"[object Array]"===Object.prototype.toString.call(t)&&t.forEach(function(t,a){var n={_index:a+1,number:t.number,name:t.name,department:t.department,remark:t.remark?t.remark:"-"};t.answers.forEach(function(e){n[e.index]=e.answer?e.answer.toString():"-"}),e.tableData.push(n)})})},methods:{fetchData:function(e){var t=this;this.$fetch.get("/api/paperAnalysis",{paperId:this.paperId},function(a){t.paper=a,e()})},deleteItem:function(e){var t=this,a=this.paper.answerList[e]._id;this.$Modal.confirm({title:"确认",content:"<p>确定删除此回卷</p>",onOk:function(){var e=t.paper.answerList.findIndex(function(e){return e._id===a});-1!==e&&t.$fetch.get("/api/deleteAnswer",{answerId:a,paperId:t.paperId},function(a){200===a&&(t.paper.answerList.splice(e,1),t.tableData.splice(e,1))})},onCancel:function(){}})},exportExcel:function(){V(this.tableColumns,this.$refs.answertable,this.paper.title+"-答题情况表")}}},K=X,Y=(a("e3ad"),Object(c["a"])(K,U,G,!1,null,"7748d0d3",null));Y.options.__file="PaperAnalysis.vue";var Z=Y.exports,ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-wrap"},[a("Card",{staticClass:"title-card"},[a("p",{staticClass:"title-text",attrs:{slot:"title"},slot:"title"},[a("span",{staticClass:"title-text"},[e._v("问卷列表")])]),a("Timeline",{staticClass:"main-content"},e._l(e.papers,function(t){return a("TimelineItem",{key:t._id,attrs:{color:"orange"}},[a("p",{staticClass:"time"},[a("span",[e._v(e._s(t.title))]),a("span",{staticClass:"actions"},[a("Tooltip",{attrs:{content:"此项已逾期",placement:"top"}},[t.outdated?a("a",{staticClass:"alert-button action-button",attrs:{href:"javascript:void (0);"}},[a("Icon",{attrs:{type:"md-information-circle"}})],1):e._e()]),a("a",{staticClass:"action-button",attrs:{href:"javascript:void (0);",title:"查看问卷详细"},on:{click:function(a){e.getDetail(t._id)}}},[a("Icon",{attrs:{type:"ios-book"}})],1),a("a",{staticClass:"action-button",attrs:{href:"javascript:void (0);",title:"查看答题分析"},on:{click:function(a){e.analyzeAnswers(t._id)}}},[a("Icon",{attrs:{type:"ios-analytics"}})],1),t.status?a("a",{staticClass:"action-button",attrs:{href:"javascript:void (0);",title:"点击暂停"},on:{click:function(a){e.toggleStatus(t._id,!t.status)}}},[a("Icon",{attrs:{type:"ios-pause"}})],1):t.status?e._e():a("a",{staticClass:"action-button",attrs:{href:"javascript:void (0);",title:"点击恢复"},on:{click:function(a){e.toggleStatus(t._id,!t.status)}}},[a("Icon",{attrs:{type:"ios-play"}})],1),a("a",{staticClass:"action-button",attrs:{title:"删除问卷"},on:{click:function(a){e.deletePaper(t._id)}}},[a("Icon",{attrs:{type:"ios-close-circle"}})],1)],1)]),a("p",{staticClass:"content"},[a("span",[e._v(e._s("问卷码："+t.code))]),a("span",[e._v(e._s("创建日期："+t.createDate))]),a("span",[e._v("|")]),a("span",[e._v(e._s("截至："+t.dateLine))]),a("span",[e._v("|")]),a("span",[e._v("应填："+e._s(t.expect))])])])}))],1)],1)},te=[],ae={data:function(){return{papers:[]}},created:function(){var e=this;this.$fetch.get("/api/papers",{},function(t){t&&(e.papers=t)})},methods:{getDetail:function(e){this.$router.push({name:"detail",params:{paperId:e}})},analyzeAnswers:function(e){this.$router.push({name:"analysis",params:{paperId:e}})},toggleStatus:function(e,t){var a=this,n=this.papers.findIndex(function(t){return t._id===e});-1!==n&&this.$fetch.get("/api/setPaperStatus",{paperId:e,status:t},function(e){200===e&&(a.papers[n].status=!a.papers[n].status)})},deletePaper:function(e){var t=this;this.$Modal.confirm({title:"确认",content:"<p>确定删除此问卷</p>",onOk:function(){var a=t.papers.findIndex(function(t){return t._id===e});-1!==a&&t.$fetch.get("/api/deletePaper",{paperId:e},function(e){200===e&&t.papers.splice(a,1)})},onCancel:function(){}})}}},ne=ae,re=(a("ed12"),Object(c["a"])(ne,ee,te,!1,null,"c6643116",null));re.options.__file="PaperList.vue";var ie=re.exports,se=[{name:"enter",path:"/",component:x},{name:"login",path:"/login",component:x},{name:"paper",path:"/paper",component:S,children:[{name:"paper_default",path:"/paper",component:ie},{name:"list",path:"/paper/list",component:ie},{name:"create",path:"/paper/create",component:N},{name:"detail",path:"/paper/detail/:paperId",component:z},{name:"analysis",path:"/paper/analysis/:paperId",component:Z}]},{name:"blank",path:"/blank/:paperCode",component:I}],oe=se,le=(a("4917"),a("6bde"));a("6d93");d["LoadingBar"].config({color:"#5cb85c",failedColor:"#f0ad4e",height:8});var ce="";function pe(e){var t=[],a=0;for(var n in e)t[a++]=[n,e[n]];return new URLSearchParams(t).toString()}function ue(e){if(e.code&&-1!==[200,201,300,400,401,500].indexOf(e.code)&&e.msg){switch(e.code){case 200:d["LoadingBar"].finish(),d["Message"].success("恭喜您，操作成功！");break;case 300:d["LoadingBar"].error(),d["Message"].warning("嗯...出错了！");break;case 400:d["LoadingBar"].error(),d["Message"].error("额...操作失败！");break;case 500:d["LoadingBar"].error(),d["Message"].warning("登陆过期，请重新登陆"),window.location.href=ce+"/login";break}return!!e.token||(!!e.paperCode||(200===e.code?200:400))}return e&&Object(le["a"])(e),d["LoadingBar"].finish(),!0}var de=window.localStorage,fe={get:function(e,t,a){e=ce+e,t&&(e.match(/^\/api*/)&&(t.token=de.getItem("token")),e+="?"+pe(t)),d["LoadingBar"].start(),fetch(e,{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(e){var t=ue(e);200===t?a&&a(200):!0===t&&a&&a(e)}).catch(function(e){ue(300),console.log(e)})},post:function(e,t,a){t&&e.match(/^\/api/)&&(t.token=de.getItem("token")),fetch(e,{method:"POST",headers:new Headers({Accept:"application/json","Content-Type":"application/json"}),body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){var t=ue(e);200===t?a&&a(200):!0===t&&a&&a(e)}).catch(function(e){ue(300),console.log(e)})}},me={install:function(e){Object.defineProperty(e.prototype,"$fetch",{value:fe})}};a("1368").polyfill(),n["default"].use(me),n["default"].config.productionTip=!1,n["default"].use(f.a),n["default"].use(r["a"]);var he=new r["a"]({routes:oe});new n["default"]({router:he,render:function(e){return e(u)}}).$mount("#app")},"59bc":function(e,t,a){"use strict";var n=a("c9d2"),r=a.n(n);r.a},7605:function(e,t,a){},a45a:function(e,t,a){},ac66:function(e,t,a){},b8ba:function(e,t,a){},c21b:function(e,t,a){},c9d2:function(e,t,a){},cf0d:function(e,t,a){"use strict";var n=a("ac66"),r=a.n(n);r.a},d1f8:function(e,t,a){"use strict";var n=a("7605"),r=a.n(n);r.a},e3ad:function(e,t,a){"use strict";var n=a("b8ba"),r=a.n(n);r.a},ed12:function(e,t,a){"use strict";var n=a("a45a"),r=a.n(n);r.a}});
//# sourceMappingURL=app.e2489d12.js.map